pr: none
trigger: none
schedules:
- cron: "0 0 * * *"
  displayName: Daily midnight build
  branches:
    include:
    - main

stages:
  - stage: SyncWikiStage
    displayName: Sync Wiki
    pool: vscode-1es-linux
    jobs:
      - job: SyncWikiJob
        displayName: Sync Wiki
        steps:
          - checkout: self
            persistCredentials: true
          - script: |
              git config user.name vscode
              git config user.email noemail@microsoft.com

              git remote add upstream https://github.com/Microsoft/vscode.wiki.git
              git fetch upstream

              echo 'Merging in vscode.wiki'
              git merge upstream/master
              
              echo 'Pushing to vscode-wiki'
              git push origin HEAD:main

              echo 'Pushing to vscode.wiki'
              git push upstream HEAD:master

              echo 'Done!'
            displayName: Sync vscode-wiki & vscode.wiki
